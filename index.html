<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>qrcodefacil</title>
  <link rel="icon" type="image/x-icon" href="verificacao-de-codigo-qr.png">
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef6;background:linear-gradient(180deg,#071022 0%, #081325 100%);}
    .wrap{max-width:880px;margin:40px auto;padding:28px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 6px 30px rgba(2,6,23,0.6);}
    header{display:flex;gap:16px;align-items:center}
    header h1{font-size:20px;margin:0}
    p.lead{color:var(--muted);margin-top:6px}

    .grid{display:grid;grid-template-columns:1fr 320px;gap:20px;margin-top:20px}
    .card{background:rgba(255,255,255,0.02);padding:18px;border-radius:10px}

    label{display:block;font-size:13px;margin-bottom:6px}
    input[type=text],textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;font-size:14px}
    .row{display:flex;gap:12px}

    .controls{display:flex;gap:8px;margin-top:12px}
    button{cursor:pointer;padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:#042027;font-weight:600}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    .preview{display:flex;flex-direction:column;align-items:center;gap:12px}
    .qrcode-box{width:260px;height:260px;background:#fff;padding:12px;border-radius:8px;display:flex;align-items:center;justify-content:center}
    img.qr{max-width:100%;height:auto;display:block}

    footer{margin-top:18px;color:var(--muted);font-size:13px}
    .small{font-size:12px;color:var(--muted)}

    @media (max-width:880px){.grid{grid-template-columns:1fr;}.qrcode-box{width:220px;height:220px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Gerador de QR Code (HTML • CSS • JS)</h1>
        <p class="lead">Digite um texto ou URL e gere um QR. Usa API pública para gerar a imagem — funciona com internet.</p>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <label for="text">Texto ou URL</label>
        <textarea id="text" rows="4" placeholder="https://exemplo.com — ou qualquer texto"></textarea>

        <div style="display:flex;gap:12px;margin-top:12px;align-items:center">
          <div style="flex:1">
            <label for="size">Tamanho (px)</label>
            <input id="size" type="number" min="100" max="2000" value="500">
          </div>
          <div style="width:120px">
            <label for="format">Formato</label>
            <select id="format"><option value="png">PNG</option><option value="svg">SVG</option></select>
          </div>
        </div>

        <div style="display:flex;gap:12px;margin-top:12px;align-items:center">
          <div style="flex:1">
            <label for="fg">Cor (frente)</label>
            <input id="fg" type="color" value="#000000">
          </div>
          <div style="flex:1">
            <label for="bg">Cor (fundo)</label>
            <input id="bg" type="color" value="#ffffff">
          </div>
        </div>

        <div class="controls">
          <button id="generate">Gerar QR</button>
          <button class="secondary" id="download" disabled>Download</button>
          <button class="secondary" id="copy" disabled>Copiar imagem</button>
          <button class="secondary" id="reset">Limpar</button>
        </div>

        <div style="margin-top:12px" class="small">Modo padrão: usa a API pública <code>api.qrserver.com</code>. Requer conexão com a internet.</div>
      </section>

      <aside class="card preview">
        <div style="text-align:center">
          <strong>Pré-visualização</strong>
        </div>
        <div class="qrcode-box" id="preview-box">
          <img class="qr" id="qrImg" alt="QR preview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1' height='1'%3E%3C/svg%3E">
        </div>

        <div id="info" class="small">Nenhum QR gerado ainda.</div>
      </aside>
    </div>

    <footer>
      <div>Feito apenas com front-end. Necessário estar online para gerar os códigos.</div>
    </footer>
  </div>

  <script>
    // Elementos
    const textEl = document.getElementById('text');
    const sizeEl = document.getElementById('size');
    const formatEl = document.getElementById('format');
    const fgEl = document.getElementById('fg');
    const bgEl = document.getElementById('bg');
    const generateBtn = document.getElementById('generate');
    const downloadBtn = document.getElementById('download');
    const copyBtn = document.getElementById('copy');
    const resetBtn = document.getElementById('reset');
    const qrImg = document.getElementById('qrImg');
    const info = document.getElementById('info');

    let lastBlobURL = null;

    function setInfo(t){ info.textContent = t }

    function sanitizeInput(s){ return s.trim(); }

    async function generate(){
      const value = sanitizeInput(textEl.value);
      if(!value){ setInfo('Digite um texto ou URL para gerar.'); return }

      const size = parseInt(sizeEl.value) || 500;
      const format = formatEl.value; // png or svg
      const fg = fgEl.value.replace('#','');
      const bg = bgEl.value.replace('#','');

      setInfo('Gerando...');
      const api = 'https://api.qrserver.com/v1/create-qr-code/';
      const params = new URLSearchParams({data: value, size: size + 'x' + size, color: fg, bgcolor: bg});
      if(format === 'svg') params.set('format','svg');

      const url = api + '?' + params.toString();

      try{
        const res = await fetch(url);
        if(!res.ok) throw new Error('Erro ao gerar (HTTP ' + res.status + ')');
        const blob = await res.blob();

        if(lastBlobURL){ URL.revokeObjectURL(lastBlobURL); lastBlobURL = null }
        lastBlobURL = URL.createObjectURL(blob);
        qrImg.src = lastBlobURL;

        downloadBtn.disabled = false;
        copyBtn.disabled = false;
        setInfo('QR gerado — tamanho ' + size + 'px — form:' + format.toUpperCase());

        downloadBtn.onclick = () => {
          const a = document.createElement('a');
          a.href = lastBlobURL;
          const ext = format === 'svg' ? 'svg' : 'png';
          a.download = 'qrcode.' + ext;
          document.body.appendChild(a);
          a.click();
          a.remove();
        };

        copyBtn.onclick = async () => {
          try{
            const c = await navigator.clipboard;
            if(!c || !c.write) throw new Error('Clipboard API não suportada');
            const clipboardItemInput = new ClipboardItem({[blob.type]: blob});
            await c.write([clipboardItemInput]);
            setInfo('Imagem copiada para a área de transferência.');
          }catch(e){
            setInfo('Não foi possível copiar: ' + e.message);
          }
        };

      }catch(err){
        console.error(err);
        setInfo('Falha ao gerar QR: ' + (err.message || err));
      }
    }

    generateBtn.addEventListener('click', generate);

    resetBtn.addEventListener('click', ()=>{
      textEl.value = '';
      qrImg.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1' height='1'%3E%3C/svg%3E";
      downloadBtn.disabled = true; copyBtn.disabled = true;
      setInfo('Campos limpos.');
      if(lastBlobURL){ URL.revokeObjectURL(lastBlobURL); lastBlobURL = null }
    });

    textEl.addEventListener('keydown', (e)=>{ if(e.ctrlKey && e.key === 'Enter'){ generate(); } });

    textEl.addEventListener('input', ()=>{
      const v = sanitizeInput(textEl.value);
      if(v.length>0) setInfo('Pronto para gerar.'); else setInfo('Digite um texto ou URL para gerar.');
    });

  </script>
</body>
</html>